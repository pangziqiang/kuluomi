<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åº“æ´›ç±³ âœ¦ 2026æš´å¯Œè·¨å¹´å€’è®¡æ—¶</title>
    <meta name="description" content="åº“æ´›ç±³ä¸»é¢˜å¤šå½©ç‚¹é˜µçƒŸèŠ±ï¼Œè¿æ¥2026æš´å¯Œæ–°å¹´ï¼">
    <meta name="theme-color" content="#4b2e83"> <!-- åº“æ´›ç±³æ·±ç´«è‰²ä¸»é¢˜è‰² -->
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            overflow: hidden;
            font-family: 'Microsoft YaHei', 'Arial Rounded MT Bold', sans-serif;
            background: linear-gradient(135deg, #1a0b2e 0%, #0d0518 50%, #2d0b5e 100%);
            color: white;
            cursor: crosshair;
            height: 100vh;
            width: 100vw;
            position: relative;
            user-select: none;
        }

        /* æ˜Ÿç©ºèƒŒæ™¯æ•ˆæœ */
        #starCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5; /* ä½äºçƒŸèŠ±ç”»å¸ƒï¼Œä¸é®æŒ¡æ ¸å¿ƒå†…å®¹ */
            pointer-events: none;
        }

        .main-container {
            position: relative;
            z-index: 30;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 25px;
            animation: fadeInDown 1.2s ease-out;
            position: relative;
            z-index: 35;
        }
        .main-title {
            font-size: 4.5rem;
            font-weight: 900;
            letter-spacing: 8px;
            /* åº“æ´›ç±³+æš´å¯Œä¸»é¢˜æ¸å˜ */
            background: linear-gradient(135deg, #4b2e83 0%, #7b4cc4 25%, #ffd700 50%, #ff6347 75%, #e8b4f8 100%);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientFlow 5s ease infinite, glowPulse 3s infinite alternate;
            text-shadow: 0 0 35px rgba(160, 32, 240, 0.7);
            margin-bottom: 10px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            position: relative;
            outline: none;
            border-bottom: 2px dashed rgba(160, 32, 240, 0.3);
            padding-bottom: 5px;
            transition: all 0.3s ease;
        }
        .main-title:focus {
            border-bottom: 2px dashed rgba(160, 32, 240, 0.8);
            background: rgba(160, 32, 240, 0.05);
            border-radius: 5px;
            padding: 5px 10px;
        }
        .main-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 4px;
            background: linear-gradient(90deg, transparent, #7b4cc4, #ffd700, transparent);
            border-radius: 2px;
        }
        .sub-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #e8b4f8; /* åº“æ´›ç±³æµ…ç²‰ç´« */
            letter-spacing: 4px;
            text-shadow: 0 0 15px rgba(160, 32, 240, 0.8);
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        .sub-title span { 
            animation: sparkle 2s infinite;
        }
        .countdown-container {
            background: rgba(38, 18, 68, 0.85); /* åº“æ´›ç±³æ·±ç´«èƒŒæ™¯ */
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 25px 45px;
            margin: 20px 0;
            border: 2px solid rgba(160, 32, 240, 0.4);
            box-shadow: 0 15px 50px rgba(75, 46, 131, 0.5), inset 0 0 30px rgba(160, 32, 240, 0.1);
            animation: fadeInUp 1.5s ease-out, float 8s ease-in-out infinite;
            position: relative;
            overflow: hidden;
            z-index: 35;
        }
        .countdown-label {
            font-size: 1.4rem;
            font-weight: bold;
            color: #e8b4f8;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 0 12px rgba(160, 32, 240, 0.9);
            letter-spacing: 2px;
            position: relative;
            z-index: 2;
        }
        .countdown-display {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        .time-unit {
            text-align: center;
            min-width: 100px;
            padding: 15px 10px;
            border-radius: 15px;
            background: linear-gradient(145deg, rgba(75, 46, 131, 0.8), rgba(38, 18, 68, 0.8));
            border: 1px solid rgba(160, 32, 240, 0.3);
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .time-unit:hover {
            transform: translateY(-8px) scale(1.05);
            border-color: rgba(160, 32, 240, 0.7);
            box-shadow: 0 15px 30px rgba(123, 76, 196, 0.5);
        }
        .time-value {
            font-size: 3.5rem;
            font-weight: 900;
            color: #ffffff;
            text-shadow: 0 0 20px rgba(160, 32, 240, 0.9), 0 0 40px rgba(75, 46, 131, 0.7), 2px 2px 8px rgba(0, 0, 0, 0.8);
            font-family: 'Courier New', 'Segoe UI', monospace;
            padding: 5px 0;
            transition: all 0.3s;
        }
        .time-label {
            font-size: 1rem;
            color: #c87ff2;
            margin-top: 8px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            text-shadow: 0 0 10px rgba(160, 32, 240, 0.8);
        }
        .separator {
            font-size: 2.5rem;
            font-weight: bold;
            color: #a020f0;
            animation: blink 1.5s infinite;
            text-shadow: 0 0 10px rgba(160, 32, 240, 0.8);
            margin: 0 5px;
            position: relative;
            top: -10px;
        }
        .datetime-display {
            background: rgba(46, 23, 82, 0.8);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 20px 35px;
            margin: 20px 0;
            border: 1px solid rgba(123, 76, 196, 0.4);
            animation: fadeIn 2s ease-out, float 7s ease-in-out infinite;
            box-shadow: 0 10px 35px rgba(46, 23, 82, 0.6);
            z-index: 35;
        }
        .current-time {
            font-size: 2rem;
            font-family: 'Courier New', monospace;
            color: #a0e7ff;
            text-shadow: 0 0 15px rgba(160, 231, 255, 0.9);
            letter-spacing: 3px;
            font-weight: bold;
            text-align: center;
        }
        .current-date {
            font-size: 1.1rem;
            color: #c87ff2;
            margin-top: 10px;
            text-align: center;
            letter-spacing: 1.5px;
        }
        .blessing-container {
            max-width: 800px;
            text-align: center;
            margin: 25px 0;
            padding: 25px 40px;
            background: rgba(53, 28, 98, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 2px solid rgba(160, 32, 240, 0.4);
            box-shadow: 0 15px 45px rgba(75, 46, 131, 0.5);
            animation: fadeIn 2.5s ease-out, float 6s ease-in-out infinite;
            position: relative;
            overflow: hidden;
            z-index: 35;
        }
        .blessing-text {
            font-size: 1.5rem;
            line-height: 1.8;
            color: #ffffff;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.6);
            font-weight: 500;
            transition: all 0.5s;
            padding: 15px;
            border-radius: 15px;
            position: relative;
            z-index: 2;
        }
        .blessing-text.highlight {
            background: rgba(160, 32, 240, 0.15);
            color: #f0c8ff;
            text-shadow: 0 0 25px rgba(160, 32, 240, 1);
            border: 1px solid rgba(160, 32, 240, 0.5);
        }

        /* æŒ‰é’®å®¹å™¨ä¿®å¤è¡Œé«˜é®æŒ¡é—®é¢˜ */
        .controls {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            animation: fadeIn 3s ease-out;
            justify-content: center;
            max-width: 100%;
            z-index: 50; /* æé«˜z-indexé¿å…è¢«é®æŒ¡ */
            position: relative;
            flex-wrap: nowrap;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 0 5px 5px; /* è°ƒæ•´å†…è¾¹è·ï¼Œç§»é™¤å¤šä½™å‚ç›´ç©ºé—´ */
            scrollbar-width: none;
            -ms-overflow-style: none;
            line-height: 1; /* å…³é”®ï¼šé‡ç½®è¡Œé«˜ä¸º1ï¼Œé¿å…é®æŒ¡æŒ‰é’®æ”¾å¤§æ•ˆæœ */
            height: auto; /* è‡ªé€‚åº”é«˜åº¦ï¼Œä¸é™åˆ¶æŒ‰é’®ä¸Šä¸‹ç©ºé—´ */
        }
        .controls::-webkit-scrollbar {
            display: none;
        }

        .btn {
            padding: 14px 28px;
            background: linear-gradient(145deg, rgba(123, 76, 196, 0.7), rgba(75, 46, 131, 0.7));
            border: 2px solid rgba(160, 32, 240, 0.7);
            border-radius: 50px;
            color: #ffffff;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease; /* æ˜ç¡®è¿‡æ¸¡æ•ˆæœï¼Œç¡®ä¿æ”¾å¤§æµç•… */
            backdrop-filter: blur(10px);
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
            font-weight: 600;
            letter-spacing: 1px;
            box-shadow: 0 8px 25px rgba(123, 76, 196, 0.5);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
            white-space: nowrap;
            line-height: 1; /* æŒ‰é’®å†…éƒ¨è¡Œé«˜é‡ç½®ï¼Œé¿å…å†…å®¹åç§» */
            transform-origin: center bottom; /* ä¼˜åŒ–æ”¾å¤§åŸç‚¹ï¼Œé¿å…è§†è§‰åç§» */
        }
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.7s;
        }
        .btn:hover {
            transform: translateY(-5px) scale(1.05); /* ç¡®ä¿æ”¾å¤§æ•ˆæœä¸å—å¤–éƒ¨è¡Œé«˜å½±å“ */
            box-shadow: 0 15px 35px rgba(160, 32, 240, 0.7);
            border-color: rgba(255, 255, 255, 0.9);
            background: linear-gradient(145deg, rgba(160, 32, 240, 0.8), rgba(123, 76, 196, 0.8));
            z-index: 60; /* æ‚¬æµ®æ—¶æé«˜å±‚çº§ï¼Œé¿å…è¢«ç›¸é‚»æŒ‰é’®é®æŒ¡ */
        }
        .btn:hover::before { left: 100%; }
        .btn.active {
            background: linear-gradient(145deg, rgba(123, 104, 238, 0.8), rgba(106, 90, 205, 0.8));
            border-color: rgba(173, 216, 230, 0.8);
            box-shadow: 0 8px 25px rgba(123, 104, 238, 0.6);
        }
        .hint-left {
            position: fixed;
            bottom: 20px;
            left: 20px;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.85);
            background: rgba(20, 10, 35, 0.4);
            padding: 10px 18px;
            border-radius: 20px;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(160, 32, 240, 0.2);
            z-index: 40;
            max-width: 300px;
            line-height: 1.5;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        .hint-left span { display: block; margin-bottom: 3px; color: #e8b4f8; }
        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4.5rem;
            font-weight: 900;
            color: #ffd700;
            text-shadow: 0 0 40px rgba(255, 215, 0, 1), 0 0 80px rgba(160, 32, 240, 0.8), 3px 3px 10px rgba(0, 0, 0, 0.8);
            animation: celebration 3s ease-out forwards;
            pointer-events: none;
            z-index: 100;
            display: none;
            letter-spacing: 5px;
            background: rgba(38, 18, 68, 0.9);
            padding: 30px 60px;
            border-radius: 30px;
            backdrop-filter: blur(20px);
            border: 3px solid rgba(255, 215, 0, 0.7);
            text-align: center;
            line-height: 1.3;
        }
        
        /* çƒŸèŠ±æ–‡å­—æ ·å¼ */
        .text-firework {
            position: fixed;
            pointer-events: none;
            z-index: 50;
            font-weight: bold;
            text-shadow: 0 0 10px currentColor;
            opacity: 0;
        }
        
        /* ç¼–è¾‘æç¤º */
        .edit-hint {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(38, 18, 68, 0.8);
            padding: 8px 15px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(160, 32, 240, 0.3);
            z-index: 40;
            max-width: 200px;
            line-height: 1.4;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            animation: fadeIn 3s ease-out;
        }
        .edit-hint span {
            display: block;
            color: #e8b4f8;
            margin-bottom: 2px;
        }
        
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes gradientFlow { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
        @keyframes glowPulse { 0%, 100% { text-shadow: 0 0 35px rgba(160, 32, 240, 0.7); } 50% { text-shadow: 0 0 55px rgba(160, 32, 240, 1), 0 0 75px rgba(255, 215, 0, 0.8); } }
        @keyframes sparkle { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        @keyframes blink { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.3; transform: scale(0.9); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes celebration { 0% { opacity: 0; transform: translate(-50%, -50%) scale(0.3) rotate(-15deg); } 50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2) rotate(5deg); } 70% { opacity: 1; transform: translate(-50%, -50%) scale(1.1) rotate(0deg); } 100% { opacity: 0; transform: translate(-50%, -50%) scale(1.5) rotate(0deg); } }
        @keyframes highlightPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.08); } }
        /* æ˜Ÿæ˜Ÿé—ªçƒåŠ¨ç”» */
        @keyframes starTwinkle {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        
        @media (max-width: 1024px) { 
            .main-title { font-size: 3.5rem; } 
            .time-unit { min-width: 85px; } 
            .time-value { font-size: 2.8rem; } 
            .controls { gap: 12px; }
            .btn { padding: 12px 22px; font-size: 1rem; }
        }
        @media (max-width: 768px) { 
            .main-title { font-size: 2.8rem; letter-spacing: 5px; } 
            .sub-title { font-size: 1.4rem; } 
            .countdown-container { padding: 20px 25px; } 
            .countdown-display { gap: 8px; } 
            .time-unit { min-width: 70px; padding: 12px 8px; } 
            .time-value { font-size: 2.2rem; } 
            .time-label { font-size: 0.9rem; } 
            .separator { font-size: 2rem; } 
            .current-time { font-size: 1.6rem; } 
            .blessing-text { font-size: 1.2rem; } 
            .btn { padding: 10px 18px; font-size: 0.95rem; } 
            .celebration { font-size: 3rem; padding: 20px 40px; } 
            .hint-left { 
                font-size: 0.75rem; 
                padding: 8px 15px; 
                max-width: 250px; 
                left: 15px; 
                bottom: 15px; 
            } 
            .edit-hint {
                font-size: 0.7rem;
                padding: 6px 12px;
                max-width: 180px;
                right: 15px;
                top: 15px;
            }
            .controls { justify-content: flex-start; padding: 0 10px 5px; }
        }
        @media (max-width: 480px) { 
            .main-title { font-size: 2.2rem; } 
            .sub-title { font-size: 1.1rem; } 
            .countdown-display { flex-wrap: wrap; } 
            .time-unit { min-width: 65px; } 
            .time-value { font-size: 1.8rem; } 
            .controls { gap: 8px; padding: 0 5px 5px; } 
            .btn { padding: 8px 14px; font-size: 0.85rem; white-space: nowrap; } 
            .hint-left { font-size: 0.7rem; padding: 6px 12px; max-width: 200px; } 
            .edit-hint { font-size: 0.65rem; padding: 5px 10px; max-width: 160px; }
        }
        .highlight-pulse { animation: highlightPulse 0.5s ease-in-out; }
        #fireworkCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; pointer-events: none; }
        .click-area { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 15; pointer-events: auto; }
    </style>
</head>
<body>
    <!-- æ˜Ÿç©ºç”»å¸ƒ -->
    <canvas id="starCanvas"></canvas>
    <canvas id="fireworkCanvas"></canvas>
    <div class="click-area" id="clickArea"></div>
    
    <div class="edit-hint">
        <span>ğŸ’¡ ç¼–è¾‘æç¤ºï¼š</span>
        ç‚¹å‡»ä¸»æ ‡é¢˜å¯ä¿®æ”¹æ–‡å­—
    </div>
    
    <div class="main-container">
        <div class="header">
            <h1 class="main-title" contenteditable="true" id="mainTitle">åº“æ´›ç±³ âœ¦ 2026æš´å¯Œ</h1>
            <div class="sub-title">
                <span>âœ¦</span> <span contenteditable="true" id="subTitle">æš´å¯Œä¸»é¢˜ç‚¹é˜µçƒŸèŠ±è·¨å¹´å€’è®¡æ—¶</span> <span>âœ¦</span>
            </div>
        </div>
        
        <div class="countdown-container">
            <div class="countdown-label">è·ç¦»2026æš´å¯Œè¿˜æœ‰</div>
            <div class="countdown-display" id="countdown">
                <div class="time-unit">
                    <div class="time-value" id="days">00</div>
                    <div class="time-label">å¤©</div>
                </div>
                <div class="separator">:</div>
                <div class="time-unit">
                    <div class="time-value" id="hours">00</div>
                    <div class="time-label">æ—¶</div>
                </div>
                <div class="separator">:</div>
                <div class="time-unit">
                    <div class="time-value" id="minutes">00</div>
                    <div class="time-label">åˆ†</div>
                </div>
                <div class="separator">:</div>
                <div class="time-unit">
                    <div class="time-value" id="seconds">00</div>
                    <div class="time-label">ç§’</div>
                </div>
            </div>
        </div>
        
        <div class="datetime-display">
            <div class="current-time" id="currentTime">00:00:00</div>
            <div class="current-date" id="currentDate">2025å¹´1æœˆ1æ—¥ æ˜ŸæœŸä¸‰</div>
        </div>
        
        <div class="blessing-container">
            <div class="blessing-text" id="blessing">æ„¿2026å¹´ï¼Œåº“æ´›ç±³é™ªä½ æš´å¯Œå‘è´¢ï¼Œè´¢æºæ»šæ»š âœ¨</div>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="manualFirework()">ğŸ† å‘å°„çƒŸèŠ±</button>
            <button class="btn" onclick="changeBlessing()">ğŸ’« æ¢ä¸ªç¥ç¦</button>
            <button class="btn active" id="autoBtn" onclick="toggleAuto()">âš¡ è‡ªåŠ¨æ¨¡å¼</button>
            <button class="btn" onclick="launchFireworksNow()">ğŸ‡ ç«‹å³ç»½æ”¾</button>
            <button class="btn" onclick="launchTextFirework()">âœ¨ æš´å¯Œæ–‡å­—</button>
            <button class="btn" onclick="launchKuromiFirework()">ğŸ‘¿ åº“æ´›ç±³</button>
        </div>
    </div>
    
    <div class="hint-left">
        <span>ğŸ† ç‚¹å‡»å±å¹•ä»»æ„ä½ç½®å‘å°„çƒŸèŠ±</span>
        <span>âŒ¨ï¸ æŒ‰ç©ºæ ¼é”®å¿«é€Ÿå‘å°„çƒŸèŠ±</span>
        <span>â‹ æŒ‰ESCé”®æ¸…ç©ºæ‰€æœ‰çƒŸèŠ±</span>
        <span>âœ¨ æŒ‰Té”®å‘å°„æš´å¯Œæ–‡å­—çƒŸèŠ±</span>
        <span>ğŸ‘¿ ç‚¹å‡»ã€Œåº“æ´›ç±³ã€è§¦å‘å¤šå½©å…¨å±å½¢è±¡</span>
        <span>ğŸ‡ å€’è®¡æ—¶ç»“æŸåå°†è‡ªåŠ¨åº†ç¥æš´å¯Œæ–°å¹´</span>
        <span>ğŸŸ¢ å¤šå½©åº“æ´›ç±³+æš´å¯Œæ–‡æ¡ˆï¼Œè´¢è¿çˆ†æ£š</span>
    </div>
    
    <div class="celebration" id="celebration">ğŸ‰ 2026ï¼Œåº“æ´›ç±³é™ªä½ æš´å¯Œå‘è´¢ï¼ğŸ‰</div>

    <script>
        // ==================== åˆå§‹åŒ–å˜é‡ ====================
        const fireworkCanvas = document.getElementById('fireworkCanvas');
        const fireworkCtx = fireworkCanvas.getContext('2d');
        const starCanvas = document.getElementById('starCanvas');
        const starCtx = starCanvas.getContext('2d');
        let stars = [];
        
        // æš´å¯Œä¸»é¢˜é…è‰²ï¼ˆé‡‘/çº¢/ç´«ä¸ºä¸»ï¼‰
        const COLORS = [
            [255, 215, 0], [255, 99, 71], [160, 32, 240], // é‡‘ã€çº¢ã€æ·±ç´«ï¼ˆæš´å¯Œ+åº“æ´›ç±³ï¼‰
            [123, 76, 196], [255, 182, 193], [255, 255, 255]
        ];
        
        // æ€§èƒ½é™åˆ¶
        const MAX_FIREWORKS = 30;
        const MAX_PARTICLES = 1500;
        const MAX_STARS = 200;
        
        // çƒŸèŠ±ç®¡ç†å™¨
        const fireworks = [];
        let autoMode = true;
        
        // æš´å¯Œä¸»é¢˜ç¥ç¦è¯­åˆ—è¡¨
        const blessingList = [
            "æ„¿2026å¹´ï¼Œåº“æ´›ç±³é™ªä½ æš´å¯Œå‘è´¢ï¼Œè´¢æºæ»šæ»š âœ¨",
            "åº“æ´›ç±³é™ªä½ è·¨å¹´ï¼Œæš´å¯Œæš´ç¾ï¼Œä¸‡äº‹é¡ºæ„ ğŸ‡",
            "2026ï¼Œå’Œåº“æ´›ç±³ä¸€èµ·ï¼Œæ—¥è¿›æ–—é‡‘ï¼Œè…°ç¼ ä¸‡è´¯ ğŸ’«",
            "çƒŸç«å‘æ˜Ÿè¾°ï¼Œåº“æ´›ç±³ä¸ä½ ï¼Œæš´å¯Œä¸å°é¡¶ ğŸŒŸ",
            "æ–°å¹´æ–°æ°”è±¡ï¼Œåº“æ´›ç±³ä¼´ä½ ï¼Œèµšå¾—ç›†æ»¡é’µæ»¡ ğŸ†",
            "åº“æ´›ç±³ç¥æ„¿ä½ ï¼Œè´¢è¿äº¨é€šï¼Œä¸€è·¯å¼€æŒ‚ ğŸ¥°",
            "æ–°å²ï¼Œåº“æ´›ç±³é™ªä½ ï¼Œæœ‰é’±æœ‰é—²ï¼Œæ— ç¾æ— éš¾ ğŸ™",
            "æ‰€æ±‚çš†å¦‚æ„¿ï¼Œæ‰€è¡Œçš†å¦é€”ï¼Œæš´å¯Œæ— æ­¢å¢ƒ âœ¨",
            "2026ï¼Œåº“æ´›ç±³ä¼´ä½ ï¼Œèººèµ¢æš´å¯Œï¼Œæœªæ¥å¯æœŸ ğŸŒ¸",
            "æ„¿æ—¶å…‰èƒ½ç¼“ï¼Œæš´å¯Œä¸æ–­ï¼Œåº“æ´›ç±³é™ªä½ å²å²å¹´å¹´ ğŸ“†"
        ];
        let lastBlessingIndex = 0;

        // ==================== åº“æ´›ç±³å¤šå½©é…è‰²+å…¨å±ç‚¹é˜µå®šä¹‰ ====================
        const KUROMI_PURPLE = [160, 32, 240]; // æ·±ç´«ï¼ˆå¤´å·¾/ä¸»ä½“ï¼Œä¿ç•™ä¸»é¢˜ï¼‰
        const KUROMI_PINK = [255, 182, 193]; // æµ…ç²‰ï¼ˆéª·é«…ï¼Œæäº®çªå‡ºï¼‰
        const KUROMI_BLACK = [20, 10, 35]; // çº¯é»‘ï¼ˆè½®å»“ï¼ŒåŠ æ·±å¯¹æ¯”ï¼‰
        const KUROMI_WHITE = [255, 255, 255]; // é«˜å…‰ï¼ˆç«‹ä½“æ„Ÿï¼‰
        // æ–°å¢å¤šå½©é…è‰²ï¼ˆå‘¼åº”æš´å¯Œä¸»é¢˜ï¼‰
        const KUROMI_BLUE = [100, 181, 246]; // å¤©è“ï¼ˆè€³å°–/è£…é¥°ï¼‰
        const KUROMI_GOLD = [255, 215, 0]; // é‡‘é»„ï¼ˆå°¾å·´/ç‚¹ç¼€ï¼Œæš´å¯Œä¸»é¢˜æ ¸å¿ƒè‰²ï¼‰
        const KUROMI_RED = [255, 99, 71]; // å¤§çº¢ï¼ˆå±€éƒ¨è£…é¥°ï¼Œå–œåº†æ‹›è´¢ï¼‰

        // åº“æ´›ç±³å…¨å±ç‚¹é˜µåæ ‡ï¼ˆæ”¾å¤§+ç‰¹å¾å¼ºåŒ–ï¼‰
        const KUROMI_DOT_MATRIX = [
            // å·¦å…”è€³ï¼ˆåŠ é•¿+ç‰¹å¾å¼ºåŒ–ï¼‰
            {x: -120, y: -210}, {x: -105, y: -240}, {x: -90, y: -270}, {x: -75, y: -240}, {x: -60, y: -210},
            {x: -105, y: -210}, {x: -90, y: -240}, {x: -75, y: -210}, {x: -110, y: -220}, {x: -80, y: -220},
            // å³å…”è€³ï¼ˆåŠ é•¿+ç‰¹å¾å¼ºåŒ–ï¼‰
            {x: 120, y: -210}, {x: 105, y: -240}, {x: 90, y: -270}, {x: 75, y: -240}, {x: 60, y: -210},
            {x: 105, y: -210}, {x: 90, y: -240}, {x: 75, y: -210}, {x: 110, y: -220}, {x: 80, y: -220},
            // å¤´å·¾ä¸Šæ²¿
            {x: -105, y: -165}, {x: -75, y: -150}, {x: -45, y: -135}, {x: 0, y: -135},
            {x: 45, y: -135}, {x: 75, y: -150}, {x: 105, y: -165}, {x: -90, y: -155}, {x: 90, y: -155},
            // å¤´å·¾å·¦ä¾§
            {x: -105, y: -135}, {x: -105, y: -105}, {x: -105, y: -75}, {x: -90, y: -45},
            {x: -75, y: -15}, {x: -60, y: 15}, {x: -45, y: 45}, {x: -100, y: -90}, {x: -95, y: -60},
            // å¤´å·¾å³ä¾§
            {x: 105, y: -135}, {x: 105, y: -105}, {x: 105, y: -75}, {x: 90, y: -45},
            {x: 75, y: -15}, {x: 60, y: 15}, {x: 45, y: 45}, {x: 100, y: -90}, {x: 95, y: -60},
            // è„¸éƒ¨è½®å»“
            {x: -60, y: 60}, {x: -30, y: 75}, {x: 0, y: 84}, {x: 30, y: 75}, {x: 60, y: 60},
            {x: -45, y: 90}, {x: 0, y: 105}, {x: 45, y: 90}, {x: -35, y: 80}, {x: 35, y: 80},
            {x: -30, y: 120}, {x: 0, y: 126}, {x: 30, y: 120}, {x: -20, y: 110}, {x: 20, y: 110},
            // ç²‰éª·é«…æ ‡å¿—ï¼ˆæ”¾å¤§+åŠ å€ç‚¹é˜µï¼‰
            {x: -24, y: -120}, {x: -15, y: -135}, {x: 0, y: -141}, {x: 15, y: -135}, {x: 24, y: -120},
            {x: 0, y: -120}, {x: -9, y: -114}, {x: 9, y: -114}, {x: -18, y: -125}, {x: 18, y: -125},
            {x: -6, y: -130}, {x: 6, y: -130}, {x: 0, y: -110},
            // æ¶é­”å°¾å·´ï¼ˆåŠ ç²—+å·æ›²å¼ºåŒ–ï¼‰
            {x: 90, y: 60}, {x: 105, y: 45}, {x: 120, y: 30}, {x: 135, y: 45}, {x: 150, y: 75},
            {x: 135, y: 105}, {x: 120, y: 120}, {x: 100, y: 50}, {x: 140, y: 60}, {x: 130, y: 90}
        ];

        // ==================== æ˜Ÿç©ºç›¸å…³å‡½æ•° ====================
        class Star {
            constructor() {
                this.x = Math.random() * starCanvas.width;
                this.y = Math.random() * starCanvas.height;
                this.radius = Math.random() * 1.5 + 0.5;
                this.opacity = Math.random() * 0.5 + 0.2;
                this.twinkleSpeed = Math.random() * 3000 + 2000;
                this.lastTwinkle = Date.now();
            }
            
            update() {
                const now = Date.now();
                if (now - this.lastTwinkle > this.twinkleSpeed) {
                    this.opacity = Math.random() * 0.5 + 0.2;
                    this.lastTwinkle = now;
                }
            }
            
            draw() {
                starCtx.save();
                starCtx.globalAlpha = this.opacity;
                starCtx.fillStyle = '#ffffff';
                starCtx.beginPath();
                starCtx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                starCtx.fill();
                starCtx.shadowBlur = 5;
                starCtx.shadowColor = 'rgba(255, 215, 0, 0.8)';
                starCtx.fill();
                starCtx.restore();
            }
        }
        
        function initStars() {
            stars = [];
            for (let i = 0; i < MAX_STARS; i++) {
                stars.push(new Star());
            }
        }
        
        function drawStars() {
            starCtx.fillStyle = 'rgba(10, 5, 20, 0.05)';
            starCtx.fillRect(0, 0, starCanvas.width, starCanvas.height);
            
            stars.forEach(star => {
                star.update();
                star.draw();
            });
            requestAnimationFrame(drawStars);
        }
        
        // ==================== ç²’å­ç±» ====================
        class Particle {
            constructor(x, y, color, isSparkle = false, type = 'normal', isDotMatrix = false) {
                this.x = x; this.y = y; this.color = color; 
                this.isSparkle = isSparkle; this.type = type;
                this.isDotMatrix = isDotMatrix;
                
                const angle = Math.random() * Math.PI * 2;
                let speed;
                
                if (this.isDotMatrix) {
                    speed = Math.random() * 0.2 + 0.05;
                } else {
                    switch(type) {
                        case 'burst': speed = Math.random() * 6 + 3; break;
                        case 'trail': speed = Math.random() * 1.5 + 0.8; break;
                        case 'heart': speed = Math.random() * 3 + 2; break;
                        case 'kuromi': speed = Math.random() * 0.8 + 0.3; break;
                        default: speed = Math.random() * 4 + 2;
                    }
                }
                
                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
                
                this.life = this.isDotMatrix ? 500 : (type === 'burst' ? 140 : type === 'trail' ? 180 : 
                           type === 'heart' ? 160 : type === 'kuromi' ? 300 : 120);
                this.maxLife = this.life;
                
                this.size = this.isDotMatrix ? 4 : (type === 'burst' ? Math.random() * 3 + 1.5 : 
                           type === 'trail' ? Math.random() * 1.5 + 0.8 : 
                           type === 'kuromi' ? Math.random() * 3 + 2 : Math.random() * 2.5 + 1.5);
                
                this.gravity = this.isDotMatrix ? 0 : (type === 'burst' ? 0.12 : type === 'trail' ? 0.04 : 
                              type === 'heart' ? 0.08 : type === 'kuromi' ? 0.01 : 0.1);
                
                this.friction = this.isDotMatrix ? 0.995 : 0.96;
                this.sparkleTimer = Math.random() * 10;
            }
            
            update() {
                this.x += this.vx; 
                this.y += this.vy; 
                this.vy += this.gravity;
                this.vx *= this.friction; 
                this.vy *= this.friction; 
                this.life -= 1;
                
                if (this.isSparkle) {
                    this.sparkleTimer--;
                    if (this.sparkleTimer <= 0) {
                        this.sparkleTimer = Math.random() * 8 + 4;
                        this.size = this.isDotMatrix ? 4 : (Math.random() * 4 + 2);
                    }
                }
                
                return this.life > 0;
            }
            
            draw(ctx) {
                if (this.life <= 0) return;
                
                const alpha = Math.min(this.life / this.maxLife, 1) * 0.95;
                const [r, g, b] = this.color;
                
                ctx.save();
                ctx.translate(this.x, this.y);
                
                const glowSize = this.isDotMatrix ? this.size * 2 : (this.type === 'burst' ? this.size * 2.5 : this.type === 'kuromi' ? this.size * 2.5 : this.size * 2);
                const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, glowSize);
                gradient.addColorStop(0, `rgba(${r}, ${g}, ${b}, ${alpha * 0.9})`);
                gradient.addColorStop(0.5, `rgba(${r}, ${g}, ${b}, ${alpha * 0.4})`);
                gradient.addColorStop(1, `rgba(${r}, ${g}, ${b}, 0)`);
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(0, 0, glowSize, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = `rgba(${Math.min(255, r + 50)}, ${Math.min(255, g + 50)}, ${Math.min(255, b + 50)}, ${alpha})`;
                
                if (this.type === 'heart') {
                    ctx.beginPath();
                    const size = this.size * 1.5;
                    for (let i = 0; i < 30; i++) {
                        const t = i / 30 * Math.PI * 2;
                        const px = 16 * Math.pow(Math.sin(t), 3);
                        const py = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
                        const scale = size / 20;
                        if (i === 0) ctx.moveTo(px * scale, py * scale); 
                        else ctx.lineTo(px * scale, py * scale);
                    }
                    ctx.closePath(); 
                    ctx.fill();
                } else {
                    ctx.beginPath(); 
                    ctx.arc(0, 0, this.isDotMatrix ? 3 : (this.type === 'kuromi' ? this.size * 1.2 : this.size), 0, Math.PI * 2); 
                    ctx.fill();
                }
                
                if (this.isSparkle && Math.random() > 0.85) {
                    ctx.fillStyle = `rgba(255, 255, 255, ${alpha * 0.8})`;
                    ctx.beginPath(); 
                    ctx.arc(0, 0, this.isDotMatrix ? 2 : (this.size * 0.5), 0, Math.PI * 2); 
                    ctx.fill();
                }
                
                ctx.restore();
            }
        }
        
        // ==================== çƒŸèŠ±ç±» ====================
        class Firework {
            constructor(x, targetY, color, type = 'normal') {
                this.x = x || Math.random() * fireworkCanvas.width;
                this.y = fireworkCanvas.height;
                this.targetY = targetY || fireworkCanvas.height / 2;
                this.speed = Math.random() * 4 + 3.5;
                this.color = color || COLORS[Math.floor(Math.random() * COLORS.length)];
                this.exploded = false;
                this.particles = [];
                this.trail = [];
                this.type = type;
                
                this.particleCount = type === 'super' ? 80 : type === 'heart' ? 60 : 
                     type === 'kuromi' ? KUROMI_DOT_MATRIX.length * 1.5 : (Math.random() > 0.6 ? 50 : 40);
                
                this.hasSparkles = type === 'super' || type === 'heart' || type === 'kuromi' || Math.random() > 0.7;
                if (type === 'super') this.speed = 5;
                if (type === 'kuromi') this.speed = 3.5;
            }
            
            update() {
                if (!this.exploded) {
                    this.y -= this.speed;
                    this.trail.push({x: this.x, y: this.y, alpha: 1, size: Math.random() * 3 + 2.5});
                    if (this.trail.length > 20) this.trail.shift();
                    if (this.y <= this.targetY) this.explode();
                } else {
                    this.particles = this.particles.filter(p => p.update());
                }
                return this.exploded ? this.particles.length > 0 : true;
            }
            
            explode() {
                this.exploded = true;
                const types = ['normal', 'burst', 'trail'];

                const isKuromiDotMatrix = this.type === 'kuromi' || (Math.random() > 0.75 && autoMode);
                if (isKuromiDotMatrix) {
                    // æ­¥éª¤1ï¼šç»˜åˆ¶å¤šå½©åº“æ´›ç±³ï¼ˆè€³å°–è“ã€å°¾å·´é‡‘ã€ä¸»ä½“ç´«ï¼‰
                    KUROMI_DOT_MATRIX.forEach(point => {
                        const offsetX = this.x + point.x;
                        const offsetY = this.y + point.y;
                        
                        // å¤šå½©é¢œè‰²åˆ†é…
                        let dotColor;
                        if (point.y < -240) {
                            // è€³å°–ï¼šå¤©è“è‰²
                            dotColor = KUROMI_BLUE;
                        } else if (point.x > 120 && point.y > 30) {
                            // å°¾å·´ï¼šé‡‘é»„è‰²ï¼ˆæš´å¯Œä¸»é¢˜ï¼‰
                            dotColor = KUROMI_GOLD;
                        } else if (point.x < -100 || point.x > 100 || point.y < -200) {
                            // è½®å»“ï¼šçº¯é»‘
                            dotColor = KUROMI_BLACK;
                        } else if (Math.random() > 0.9) {
                            // éšæœºç‚¹ç¼€ï¼šå¤§çº¢/é‡‘é»„ï¼ˆæ‹›è´¢å–œåº†ï¼‰
                            dotColor = Math.random() > 0.5 ? KUROMI_RED : KUROMI_GOLD;
                        } else {
                            // ä¸»ä½“ï¼šæ·±ç´«ï¼ˆä¿ç•™åº“æ´›ç±³è¾¨è¯†åº¦ï¼‰
                            dotColor = KUROMI_PURPLE;
                        }
                        
                        const particle = new Particle(
                            offsetX, offsetY,
                            dotColor,
                            this.hasSparkles, 'kuromi', true
                        );
                        this.particles.push(particle);
                    });

                    // æ­¥éª¤2ï¼šç»˜åˆ¶ç²‰é‡‘éª·é«…ï¼ˆæ ¸å¿ƒç‰¹å¾+æš´å¯Œå‘¼åº”ï¼‰
                    KUROMI_DOT_MATRIX.filter(p => (p.x >= -30 && p.x <= 30) && (p.y >= -150 && p.y <= -105)).forEach(point => {
                        const offsetX = this.x + point.x;
                        const offsetY = this.y + point.y;
                        
                        // éª·é«…ç²‰+é‡‘é«˜å…‰ï¼Œå‘¼åº”æš´å¯Œä¸»é¢˜
                        const skullColor = Math.random() > 0.7 ? KUROMI_GOLD : KUROMI_PINK;
                        const particle = new Particle(
                            offsetX, offsetY,
                            skullColor,
                            true, 'kuromi', true
                        );
                        this.particles.push(particle);
                    });

                    // æ­¥éª¤3ï¼šç»˜åˆ¶é«˜å…‰+å¤šå½©è¡¥ç‚¹
                    KUROMI_DOT_MATRIX.filter(p => (p.y < -120 && (p.x > -60 && p.x < 60))).forEach(point => {
                        const offsetX = this.x + point.x;
                        const offsetY = this.y + point.y;
                        
                        const highlightColor = Math.random() > 0.8 ? KUROMI_GOLD : KUROMI_WHITE;
                        const particle = new Particle(
                            offsetX, offsetY,
                            highlightColor,
                            true, 'kuromi', true
                        );
                        this.particles.push(particle);
                    });

                    // æ­¥éª¤4ï¼šå¤šå½©æŒç»­é—ªçƒ
                    setTimeout(() => {
                        KUROMI_DOT_MATRIX.forEach(point => {
                            const offsetX = this.x + point.x;
                            const offsetY = this.y + point.y;
                            
                            let flashColor;
                            if (point.y < -240) {
                                flashColor = KUROMI_BLUE;
                            } else if (point.x > 120 && point.y > 30) {
                                flashColor = KUROMI_GOLD;
                            } else if (point.x >= -30 && point.x <= 30 && point.y >= -150 && point.y <= -105) {
                                flashColor = KUROMI_PINK;
                            } else {
                                flashColor = Math.random() > 0.7 ? KUROMI_GOLD : KUROMI_PURPLE;
                            }
                            
                            const particle = new Particle(
                                offsetX, offsetY,
                                flashColor,
                                true, 'kuromi', true
                            );
                            this.particles.push(particle);
                        });
                    }, 800);
                    
                    // æ­¥éª¤5ï¼šå…¨å±è½®å»“è¡¥ç‚¹ï¼ˆé»‘+é‡‘ï¼‰
                    setTimeout(() => {
                        KUROMI_DOT_MATRIX.filter(p => (p.x < -90 || p.x > 90 || p.y > 100)).forEach(point => {
                            const offsetX = this.x + point.x;
                            const offsetY = this.y + point.y;
                            
                            const borderColor = Math.random() > 0.8 ? KUROMI_GOLD : KUROMI_BLACK;
                            const particle = new Particle(
                                offsetX, offsetY,
                                borderColor,
                                false, 'kuromi', true
                            );
                            this.particles.push(particle);
                        });
                    }, 1200);
                } else {
                    // æ™®é€šçƒŸèŠ±é€»è¾‘
                    for (let i = 0; i < this.particleCount; i++) {
                        let type = types[Math.floor(Math.random() * types.length)];
                        this.particles.push(new Particle(this.x, this.y, this.color, this.hasSparkles, type));
                    }
                }
                
                if (!isKuromiDotMatrix && this.hasSparkles) {
                    for (let i = 0; i < 15; i++) {
                        this.particles.push(new Particle(this.x, this.y, [255, 255, 255], true, 'burst'));
                    }
                }
                
                if (!isKuromiDotMatrix && this.type === 'super') {
                    setTimeout(() => {
                        for (let i = 0; i < 20; i++) {
                            this.particles.push(new Particle(this.x, this.y, [255, 255, 255], true, 'burst'));
                        }
                    }, 300);
                }
                
                if (!isKuromiDotMatrix && Math.random() > 0.7 && this.type !== 'heart') {
                    setTimeout(() => {
                        createTextFirework(this.x, this.y);
                    }, 100);
                }
            }
            
            draw(ctx) {
                if (!this.exploded) {
                    ctx.save();
                    const glowColor = this.type === 'kuromi' ? `rgb(${KUROMI_PURPLE[0]}, ${KUROMI_PURPLE[1]}, ${KUROMI_PURPLE[2]})` : `rgb(${this.color[0]}, ${this.color[1]}, ${this.color[2]})`;
                    ctx.shadowBlur = 30;
                    ctx.shadowColor = glowColor;
                    const fillColor = this.type === 'kuromi' ? `rgb(${Math.min(255, KUROMI_PURPLE[0] + 60)}, ${Math.min(255, KUROMI_PURPLE[1] + 60)}, ${Math.min(255, KUROMI_PURPLE[2] + 60)})` : `rgb(${Math.min(255, this.color[0] + 40)}, ${Math.min(255, this.color[1] + 40)}, ${Math.min(255, this.color[2] + 40)})`;
                    ctx.fillStyle = fillColor;
                    ctx.beginPath(); 
                    ctx.arc(this.x, this.y, 8, 0, Math.PI * 2); 
                    ctx.fill();
                    
                    const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, 20);
                    gradient.addColorStop(0, this.type === 'kuromi' ? `rgba(${KUROMI_PURPLE[0]}, ${KUROMI_PURPLE[1]}, ${KUROMI_PURPLE[2]}, 0.8)` : `rgba(${this.color[0]}, ${this.color[1]}, ${this.color[2]}, 0.7)`);
                    gradient.addColorStop(1, this.type === 'kuromi' ? `rgba(${KUROMI_PURPLE[0]}, ${KUROMI_PURPLE[1]}, ${KUROMI_PURPLE[2]}, 0)` : `rgba(${this.color[0]}, ${this.color[1]}, ${this.color[2]}, 0)`);
                    ctx.fillStyle = gradient;
                    ctx.beginPath(); 
                    ctx.arc(this.x, this.y, 20, 0, Math.PI * 2); 
                    ctx.fill();
                    ctx.restore();
                    
                    this.trail.forEach((point, index) => {
                        ctx.save();
                        const trailAlpha = point.alpha * (index / this.trail.length) * 0.8;
                        ctx.globalAlpha = trailAlpha;
                        const gradient = ctx.createRadialGradient(point.x, point.y, 0, point.x, point.y, point.size * 2);
                        gradient.addColorStop(0, this.type === 'kuromi' ? `rgba(${KUROMI_PURPLE[0]}, ${KUROMI_PURPLE[1]}, ${KUROMI_PURPLE[2]}, ${trailAlpha})` : `rgba(${this.color[0]}, ${this.color[1]}, ${this.color[2]}, ${trailAlpha})`);
                        gradient.addColorStop(1, this.type === 'kuromi' ? `rgba(${KUROMI_PURPLE[0]}, ${KUROMI_PURPLE[1]}, ${KUROMI_PURPLE[2]}, 0)` : `rgba(${this.color[0]}, ${this.color[1]}, ${this.color[2]}, 0)`);
                        ctx.fillStyle = gradient;
                        ctx.beginPath(); 
                        ctx.arc(point.x, point.y, point.size * 2, 0, Math.PI * 2); 
                        ctx.fill();
                        ctx.restore();
                        point.alpha -= 0.03;
                    });
                } else {
                    this.particles.forEach(p => p.draw(ctx));
                }
            }
        }
        
        // ==================== æš´å¯Œæ–‡å­—çƒŸèŠ±ç³»ç»Ÿ ====================
        function createTextFirework(x, y) {
            // 80%ä»¥ä¸Šä¸ºå‘è´¢æš´å¯Œæ–‡æ¡ˆï¼Œå°‘é‡æ–°å¹´ç¥ç¦
            const blessings = [
                "ä½ ä¸€å®šè¦å‘è´¢",
                "2026å¹´ä½ æš´å¯Œ",
                "æš´å¯Œæš´ç¾æš´é¡ºåˆ©",
                "æ‹›è´¢è¿›å®ï¼Œè´¢æºå¹¿è¿›",
                "æ—¥è¿›æ–—é‡‘ï¼Œè…°ç¼ ä¸‡è´¯",
                "2026è´¢è¿äº¨é€š",
                "æš´å¯Œä¸å°é¡¶ï¼Œå‘è´¢æ— æ­¢å¢ƒ",
                "æœ‰é’±æœ‰é—²ï¼Œä¸‡äº‹é¡ºæ„",
                "è´¢æºæ»šæ»šï¼Œå¥½è¿è¿è¿",
                "2026èººèµ¢æš´å¯Œ",
                "æ­å–œå‘è´¢ï¼Œå¤§å‰å¤§åˆ©",
                "æš´å¯Œä¸Šå²¸ï¼Œä¸‡äº‹æ— å¿§",
                "è´¢è¿çˆ†æ£šï¼Œä¸€è·¯å¼€æŒ‚",
                "2026èµšå¾—ç›†æ»¡é’µæ»¡",
                "å¯Œè´µå‰ç¥¥ï¼Œè´¢æºæ»šæ»š",
                "åº“æ´›ç±³é™ªä½ æš´å¯Œ",
                "å¿ƒæƒ³äº‹æˆï¼Œè´¢æºå¹¿è¿›",
                "2026æš´å¯Œå˜ç¾",
                "æ‹›è´¢çº³ç¦ï¼Œæš´å¯Œæ— å¿§",
                "èµšé’±å¤šå¤šï¼Œå¿«ä¹å¤šå¤š",
                "æ–°å¹´å¿«ä¹",
                "2026å¿«ä¹"
            ];
            
            const text = blessings[Math.floor(Math.random() * blessings.length)];
            // ä¼˜å…ˆé€‰æ‹©æš´å¯Œé…è‰²ï¼ˆé‡‘/çº¢/ç´«ï¼‰
            const fortuneColors = [
                [255, 215, 0], [255, 99, 71], [160, 32, 240], [123, 76, 196], [255, 182, 193]
            ];
            const color = fortuneColors[Math.floor(Math.random() * fortuneColors.length)];
            
            // æ–¹æ¡ˆ1ï¼šæ•´ä¸ªæ–‡å­—çƒŸèŠ±æ•ˆæœ
            createFullTextFirework(x, y, text, color);
            
            // æ–¹æ¡ˆ2ï¼šæ–‡å­—ç²’å­æ•ˆæœ
            if (Math.random() > 0.5) {
                setTimeout(() => {
                    createTextParticles(x, y, text, color);
                }, 300);
            }
        }
        
        function createFullTextFirework(x, y, text, color) {
            const textEl = document.createElement('div');
            textEl.className = 'text-firework';
            textEl.textContent = text;
            textEl.style.color = `rgb(${color[0]}, ${color[1]}, ${color[2]})`;
            textEl.style.left = x + 'px';
            textEl.style.top = y + 'px';
            textEl.style.fontSize = (Math.random() * 40 + 60) + 'px';
            textEl.style.textShadow = `0 0 40px rgb(${color[0]}, ${color[1]}, ${color[2]})`;
            
            document.body.appendChild(textEl);
            
            const animationDuration = 2000 + Math.random() * 1000;
            const endX = x + (Math.random() - 0.5) * 200;
            const endY = y - 100 - Math.random() * 200;
            
            textEl.style.transition = `all ${animationDuration}ms cubic-bezier(0.34, 1.56, 0.64, 1)`;
            textEl.style.opacity = '1';
            textEl.style.transform = `translate(${endX - x}px, ${endY - y}px) scale(3)`;
            
            setTimeout(() => {
                textEl.style.opacity = '0';
                setTimeout(() => {
                    if (textEl.parentNode) {
                        document.body.removeChild(textEl);
                    }
                }, 500);
            }, animationDuration - 500);
        }
        
        function createTextParticles(x, y, text, color) {
            const chars = text.split('');
            const centerX = x;
            const centerY = y;
            
            chars.forEach((char, index) => {
                setTimeout(() => {
                    const charEl = document.createElement('div');
                    charEl.className = 'text-firework';
                    charEl.textContent = char;
                    charEl.style.color = `rgb(${color[0]}, ${color[1]}, ${color[2]})`;
                    charEl.style.left = centerX + 'px';
                    charEl.style.top = centerY + 'px';
                    charEl.style.fontSize = (Math.random() * 30 + 40) + 'px';
                    charEl.style.textShadow = `0 0 30px rgb(${color[0]}, ${color[1]}, ${color[2]})`;
                    
                    document.body.appendChild(charEl);
                    
                    const angle = (index / chars.length) * Math.PI * 2;
                    const distance = 200 + Math.random() * 100;
                    const endX = Math.cos(angle) * distance;
                    const endY = Math.sin(angle) * distance;
                    
                    charEl.style.transition = `all 2000ms cubic-bezier(0.34, 1.56, 0.64, 1)`;
                    setTimeout(() => {
                        charEl.style.opacity = '1';
                        charEl.style.transform = `translate(${endX}px, ${endY}px) scale(1.5) rotate(10deg)`;
                    }, 10);
                    
                    setTimeout(() => {
                        charEl.style.transform = `translate(${endX*0.7}px, ${endY*0.7}px) scale(1.3) rotate(-5deg)`;
                    }, 600);
                    
                    setTimeout(() => {
                        charEl.style.transform = `translate(${endX}px, ${endY}px) scale(1.2) rotate(0deg)`;
                    }, 1200);
                    
                    setTimeout(() => {
                        charEl.style.opacity = '0';
                        charEl.style.transform = `translate(${endX*1.1}px, ${endY*1.1}px) scale(1) rotate(5deg)`;
                    }, 1500);
                    
                    setTimeout(() => {
                        if (charEl.parentNode) {
                            document.body.removeChild(charEl);
                        }
                    }, 2000);
                    
                }, index * 100);
            });
        }
        
        function launchTextFirework() {
            const x = Math.random() * fireworkCanvas.width;
            const y = Math.random() * (fireworkCanvas.height * 0.4) + 50;
            const color = COLORS[Math.floor(Math.random() * COLORS.length)];
            
            fireworks.push(new Firework(x, y, color, 'super'));
            
            setTimeout(() => {
                createTextFirework(x, y);
            }, 800);
        }
        
        // ==================== åº“æ´›ç±³çƒŸèŠ±æ‰‹åŠ¨è§¦å‘ ====================
        function launchKuromiFirework() {
            const x = fireworkCanvas.width / 2;
            const y = fireworkCanvas.height / 2;
            const color = KUROMI_PURPLE;
            
            for (let i = 0; i < 2; i++) {
                setTimeout(() => {
                    const offsetX = x + (Math.random() - 0.5) * 30;
                    const offsetY = y + (Math.random() - 0.5) * 20;
                    fireworks.push(new Firework(offsetX, offsetY, color, 'kuromi'));
                    
                    if (i === 0) {
                        setTimeout(() => {
                            createFullTextFirework(offsetX, offsetY - 100, "2026æš´å¯Œ", KUROMI_GOLD);
                        }, 1500);
                    }
                }, i * 1000);
            }
        }
        
        // ==================== çƒŸèŠ±ç®¡ç†å‡½æ•° ====================
        function backgroundLaunch() {
            if (autoMode && fireworks.length < 18) {
                if (Math.random() < 0.03) {
                    const x = Math.random() * fireworkCanvas.width;
                    const color = COLORS[Math.floor(Math.random() * COLORS.length)];
                    fireworks.push(new Firework(x, null, color, 'normal'));
                }
                if (Math.random() < 0.008) {
                    const x = Math.random() * fireworkCanvas.width;
                    const color = COLORS[Math.floor(Math.random() * COLORS.length)];
                    fireworks.push(new Firework(x, Math.random() * 100 + 50, color, 'super'));
                }
                if (Math.random() < 0.003) {
                    const x = fireworkCanvas.width / 2;
                    fireworks.push(new Firework(x, fireworkCanvas.height / 2, KUROMI_PURPLE, 'kuromi'));
                }
            }
        }
        
        function manualFirework(x, y) {
            const count = Math.random() > 0.8 ? 2 : 1;
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const targetY = y ? y - Math.random() * 100 : Math.random() * (fireworkCanvas.height * 0.4) + 50;
                    const type = Math.random() > 0.7 ? 'super' : Math.random() > 0.5 ? 'heart' : (Math.random() > 0.8 ? 'kuromi' : 'normal');
                    const color = type === 'kuromi' ? KUROMI_PURPLE : COLORS[Math.floor(Math.random() * COLORS.length)];
                    fireworks.push(new Firework(x, targetY, color, type));
                }, i * 150);
            }
        }
        
        function launchFireworksNow() {
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    const x = Math.random() * fireworkCanvas.width;
                    const color = COLORS[Math.floor(Math.random() * COLORS.length)];
                    fireworks.push(new Firework(x, Math.random() * 100 + 50, color, 'super'));
                }, i * 200);
            }
            
            setTimeout(() => {
                launchKuromiFirework();
            }, 1000);
            
            setTimeout(() => {
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        const x = Math.random() * fireworkCanvas.width;
                        const y = Math.random() * (fireworkCanvas.height * 0.4) + 50;
                        createTextFirework(x, y);
                    }, i * 500);
                }
            }, 1000);
        }
        
        function toggleAuto() {
            autoMode = !autoMode;
            const btn = document.getElementById('autoBtn');
            btn.classList.toggle('active');
            btn.textContent = autoMode ? 'âš¡ è‡ªåŠ¨æ¨¡å¼' : 'â–¶ æ‰‹åŠ¨æ¨¡å¼';
        }
        
        // ==================== ç¥ç¦åˆ‡æ¢å‡½æ•° ====================
        function changeBlessing() {
            const blessingEl = document.getElementById('blessing');
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * blessingList.length);
            } while (newIndex === lastBlessingIndex);
            lastBlessingIndex = newIndex;
            
            blessingEl.classList.add('highlight', 'highlight-pulse');
            setTimeout(() => {
                blessingEl.textContent = blessingList[newIndex];
                setTimeout(() => {
                    blessingEl.classList.remove('highlight');
                }, 500);
            }, 200);
        }
        
        // ==================== çƒŸèŠ±åŠ¨ç”»å¾ªç¯ ====================
        function animateFireworks() {
            fireworkCtx.fillStyle = 'rgba(10, 5, 20, 0.1)';
            fireworkCtx.fillRect(0, 0, fireworkCanvas.width, fireworkCanvas.height);
            
            backgroundLaunch();
            checkPerformanceLimits();
            
            for (let i = fireworks.length - 1; i >= 0; i--) {
                const fw = fireworks[i];
                if (!fw.update()) {
                    fireworks.splice(i, 1);
                } else {
                    fw.draw(fireworkCtx);
                }
            }
            requestAnimationFrame(animateFireworks);
        }
        
        // ==================== æ€§èƒ½æ£€æŸ¥ ====================
        function checkPerformanceLimits() {
            if (fireworks.length > MAX_FIREWORKS) {
                fireworks.splice(0, fireworks.length - MAX_FIREWORKS);
            }
            
            let totalParticles = 0;
            fireworks.forEach(fw => totalParticles += fw.particles.length);
            
            if (totalParticles > MAX_PARTICLES) {
                while (totalParticles > MAX_PARTICLES && fireworks.length > 0) {
                    totalParticles -= fireworks[0].particles.length;
                    fireworks.shift();
                }
            }
        }
        
        // ==================== å€’è®¡æ—¶ç³»ç»Ÿ ====================
        function updateCountdown() {
            const now = new Date();
            const target = new Date('2026-01-01T00:00:00');
            const diff = target - now;
            
            if (diff <= 0) {
                document.getElementById('countdown').innerHTML = '<div style="font-size:1.8rem;color:#ffd700;text-shadow:0 0 25px rgba(255,215,0,1);padding:20px;">ğŸ‰ 2026ï¼Œæš´å¯Œå¼€å§‹ï¼ğŸ‰</div>';
                const celebration = document.getElementById('celebration');
                celebration.style.display = 'block';
                
                setTimeout(() => { 
                    celebration.style.display = 'none'; 
                }, 3000);
                
                for (let i = 0; i < 12; i++) {
                    setTimeout(() => {
                        const x = i % 2 === 0 ? fireworkCanvas.width / 2 : Math.random() * fireworkCanvas.width;
                        const color = i % 3 === 0 ? KUROMI_GOLD : COLORS[Math.floor(Math.random() * COLORS.length)];
                        const type = i % 4 === 0 ? 'kuromi' : 'super';
                        fireworks.push(new Firework(x, i % 2 === 0 ? fireworkCanvas.height / 2 : Math.random() * 100 + 50, color, type));
                    }, i * 200);
                }
                return;
            }
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            document.getElementById('days').textContent = days.toString().padStart(2, '0');
            document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
        }
        
        // ==================== å½“å‰æ—¶é—´/æ—¥æœŸæ›´æ–° ====================
        function updateCurrentDateTime() {
            const now = new Date();
            const weekdays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
            
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            document.getElementById('currentTime').textContent = `${hours}:${minutes}:${seconds}`;
            
            const year = now.getFullYear();
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            const day = now.getDate().toString().padStart(2, '0');
            const weekday = weekdays[now.getDay()];
            document.getElementById('currentDate').textContent = `${year}å¹´${month}æœˆ${day}æ—¥ ${weekday}`;
        }
        
        // ==================== äº‹ä»¶ç›‘å¬ ====================
        function initEventListeners() {
            clickArea.addEventListener('click', (e) => {
                manualFirework(e.clientX, e.clientY);
            });
            
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case ' ':
                        e.preventDefault();
                        manualFirework();
                        break;
                    case 'Escape':
                        fireworks.length = 0;
                        break;
                    case 't':
                    case 'T':
                        launchTextFirework();
                        break;
                    case 'k':
                    case 'K':
                        e.preventDefault();
                        launchKuromiFirework();
                        break;
                }
            });
            
            window.addEventListener('resize', resizeCanvas);
        }
        
        // ==================== åˆå§‹åŒ–ç³»ç»Ÿ ====================
        function resizeCanvas() {
            fireworkCanvas.width = window.innerWidth;
            fireworkCanvas.height = window.innerHeight;
            starCanvas.width = window.innerWidth;
            starCanvas.height = window.innerHeight;
            initStars();
        }
        
        function init() {
            resizeCanvas();
            initEventListeners();
            initStars();
            drawStars();
            animateFireworks();
            
            updateCountdown();
            updateCurrentDateTime();
            
            setInterval(() => {
                updateCountdown();
                updateCurrentDateTime();
            }, 1000);
        }
        
        // å¯åŠ¨åº”ç”¨
        window.onload = init;
    </script>
</body>
</html>
